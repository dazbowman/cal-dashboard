<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Cal's Dashboard</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
</head>
<body>
  <div class="app">
    <!-- Left Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <span class="logo-text">Caliopus</span>
        <div class="profile-avatar" id="profile-avatar">
          <div class="avatar-ring" id="avatar-ring"></div>
          <div class="avatar-image">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <!-- Cat face -->
              <circle cx="50" cy="55" r="35" fill="#4a4a5c"/>
              <!-- Ears -->
              <polygon points="20,35 30,10 45,30" fill="#4a4a5c"/>
              <polygon points="80,35 70,10 55,30" fill="#4a4a5c"/>
              <polygon points="25,32 32,15 42,28" fill="#3d3d4d"/>
              <polygon points="75,32 68,15 58,28" fill="#3d3d4d"/>
              <!-- Eyes -->
              <ellipse cx="35" cy="50" rx="8" ry="10" fill="#1a1a2e"/>
              <ellipse cx="65" cy="50" rx="8" ry="10" fill="#1a1a2e"/>
              <ellipse cx="37" cy="48" rx="4" ry="5" fill="#a855f7"/>
              <ellipse cx="67" cy="48" rx="4" ry="5" fill="#a855f7"/>
              <circle cx="38" cy="46" r="2" fill="#fff"/>
              <circle cx="68" cy="46" r="2" fill="#fff"/>
              <!-- Nose -->
              <ellipse cx="50" cy="62" rx="5" ry="4" fill="#3d3d4d"/>
              <!-- Mouth -->
              <path d="M 45 68 Q 50 73 55 68" stroke="#3d3d4d" stroke-width="2" fill="none"/>
              <!-- Whiskers -->
              <line x1="15" y1="55" x2="30" y2="58" stroke="#6b6b7a" stroke-width="1.5"/>
              <line x1="15" y1="62" x2="30" y2="62" stroke="#6b6b7a" stroke-width="1.5"/>
              <line x1="15" y1="69" x2="30" y2="66" stroke="#6b6b7a" stroke-width="1.5"/>
              <line x1="85" y1="55" x2="70" y2="58" stroke="#6b6b7a" stroke-width="1.5"/>
              <line x1="85" y1="62" x2="70" y2="62" stroke="#6b6b7a" stroke-width="1.5"/>
              <line x1="85" y1="69" x2="70" y2="66" stroke="#6b6b7a" stroke-width="1.5"/>
            </svg>
          </div>
        </div>
      </div>
      
      <nav class="nav">
        <a href="#" class="nav-item active" data-page="dashboard">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="7" height="7" rx="1"/>
            <rect x="14" y="3" width="7" height="7" rx="1"/>
            <rect x="3" y="14" width="7" height="7" rx="1"/>
            <rect x="14" y="14" width="7" height="7" rx="1"/>
          </svg>
          <span class="nav-text">Dashboard</span>
        </a>
        <a href="#" class="nav-item" data-page="chat">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
          </svg>
          <span class="nav-text">Chat</span>
        </a>
        <a href="#" class="nav-item" data-page="dna">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M2 15c6.667-6 13.333 0 20-6"/>
            <path d="M9 22c1.798-1.998 2.518-3.995 2.807-5.993"/>
            <path d="M15 2c-1.798 1.998-2.518 3.995-2.807 5.993"/>
            <path d="M17 6l-2.5-2.5"/>
            <path d="M14 8l-3-3"/>
            <path d="M7 18l2.5 2.5"/>
            <path d="M10 16l3 3"/>
          </svg>
          <span class="nav-text">DNA</span>
        </a>
        <a href="#" class="nav-item" data-page="memory">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M12 2a4 4 0 0 1 4 4v1a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"/>
            <path d="M16 10a4 4 0 0 1 4 4v1a4 4 0 0 1-8 0v-1a4 4 0 0 1 4-4z" transform="translate(-4 3)"/>
            <path d="M8 10a4 4 0 0 1 4 4v1a4 4 0 0 1-8 0v-1a4 4 0 0 1 4-4z" transform="translate(4 3)"/>
          </svg>
          <span class="nav-text">Memory</span>
        </a>
        <a href="#" class="nav-item" data-page="skills">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
          </svg>
          <span class="nav-text">Skills</span>
        </a>
        <a href="#" class="nav-item" data-page="cron">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
          <span class="nav-text">Cron Jobs</span>
        </a>
        <a href="#" class="nav-item" data-page="schedule">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          <span class="nav-text">Schedule</span>
        </a>
        <a href="#" class="nav-item" data-page="goals">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="12" r="10"/>
            <circle cx="12" cy="12" r="6"/>
            <circle cx="12" cy="12" r="2"/>
          </svg>
          <span class="nav-text">Goals</span>
        </a>
        <a href="#" class="nav-item" data-page="todo">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M9 11l3 3L22 4"/>
            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
          </svg>
          <span class="nav-text">To Do List</span>
        </a>
        <a href="#" class="nav-item" data-page="missions">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/>
            <path d="M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/>
            <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/>
            <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/>
          </svg>
          <span class="nav-text">Mission Queue</span>
        </a>
        <a href="#" class="nav-item" data-page="settings">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
          <span class="nav-text">Settings</span>
        </a>
      </nav>
      
      <div class="sidebar-footer">
        <div class="version">v1.0.0</div>
      </div>
    </aside>

    <!-- Mobile Header -->
    <header class="mobile-header">
      <button class="menu-btn" id="menu-btn">‚ò∞</button>
      <div class="mobile-logo">üê± Cal</div>
      <button class="chat-btn" id="mobile-chat-btn">üí¨</button>
    </header>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
      <!-- Dashboard Page -->
      <div class="page active" id="page-dashboard">
        <div class="page-header">
          <h1>Dashboard</h1>
          <span class="page-subtitle">Overview of Cal's activities</span>
        </div>
        
        <div class="dashboard-grid">
          <!-- Pi System Stats - 4 cards in a row -->
          <div class="stats-row">
            <div class="card stat-card gauge-card">
              <span class="stat-label">CPU Usage</span>
              <div class="gauge-container">
                <svg class="gauge" viewBox="0 0 120 70">
                  <defs>
                    <linearGradient id="gauge-gradient-cpu" x1="0%" y1="0%" x2="100%" y2="0%">
                      <stop offset="0%" style="stop-color:#10b981"/>
                      <stop offset="50%" style="stop-color:#f59e0b"/>
                      <stop offset="100%" style="stop-color:#ef4444"/>
                    </linearGradient>
                  </defs>
                  <path class="gauge-bg" d="M 10 65 A 50 50 0 0 1 110 65" fill="none" stroke-width="12" stroke-linecap="round"/>
                  <path class="gauge-fill" id="cpu-gauge" d="M 10 65 A 50 50 0 0 1 110 65" fill="none" stroke="url(#gauge-gradient-cpu)" stroke-width="12" stroke-linecap="round" stroke-dasharray="0 157"/>
                  <text class="gauge-value" id="pi-cpu" x="60" y="58" text-anchor="middle">--%</text>
                </svg>
              </div>
            </div>
            <div class="card stat-card gauge-card">
              <span class="stat-label">Memory</span>
              <span class="stat-detail" id="pi-memory-detail">-- / --</span>
              <div class="gauge-container">
                <svg class="gauge" viewBox="0 0 120 70">
                  <defs>
                    <linearGradient id="gauge-gradient-mem" x1="0%" y1="0%" x2="100%" y2="0%">
                      <stop offset="0%" style="stop-color:#10b981"/>
                      <stop offset="50%" style="stop-color:#f59e0b"/>
                      <stop offset="100%" style="stop-color:#ef4444"/>
                    </linearGradient>
                  </defs>
                  <path class="gauge-bg" d="M 10 65 A 50 50 0 0 1 110 65" fill="none" stroke-width="12" stroke-linecap="round"/>
                  <path class="gauge-fill" id="memory-gauge" d="M 10 65 A 50 50 0 0 1 110 65" fill="none" stroke="url(#gauge-gradient-mem)" stroke-width="12" stroke-linecap="round" stroke-dasharray="0 157"/>
                  <text class="gauge-value" id="pi-memory" x="60" y="58" text-anchor="middle">--%</text>
                </svg>
              </div>
            </div>
            <div class="card stat-card">
              <div class="stat-header">
                <span class="stat-icon">üíø</span>
                <span class="stat-value" id="pi-disk">--</span>
              </div>
              <span class="stat-label">Disk</span>
              <div class="stat-bar">
                <div class="stat-bar-fill disk-fill" id="pi-disk-bar" style="width: 0%"></div>
              </div>
            </div>
            <div class="card stat-card temp-card">
              <div class="stat-header">
                <span class="stat-icon">üå°Ô∏è</span>
                <span class="stat-value" id="pi-temp">--</span>
              </div>
              <span class="stat-label">Temperature</span>
              <div class="temp-mini-chart">
                <canvas id="temp-chart"></canvas>
              </div>
            </div>
          </div>

          <!-- Main content row - 50/50 split -->
          <div class="main-row">
            <div class="card main-card">
              <h3>Current Work</h3>
              <div class="current-work" id="current-work">
                <div class="empty-state">Nothing in progress</div>
              </div>
            </div>
            
            <div class="card main-card">
              <h3>Cron Jobs</h3>
              <div class="cron-mini" id="cron-mini">
                <div class="empty-state">Loading...</div>
              </div>
            </div>
          </div>

          <!-- Secondary row -->
          <div class="secondary-row">
            <div class="card">
              <h3>Activity Feed</h3>
              <div class="activity-filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="tool">Tools</button>
                <button class="filter-btn" data-filter="assistant">Assistant</button>
                <button class="filter-btn" data-filter="user">User</button>
              </div>
              <div class="activity-list" id="activity-list">
                <div class="empty-state">No recent activity</div>
              </div>
            </div>
            
            <div class="card">
              <h3>Token Usage</h3>
              <div class="token-stats" id="token-stats">
                <div class="stat">
                  <span class="stat-value">--</span>
                  <span class="stat-label">Today</span>
                </div>
                <div class="stat">
                  <span class="stat-value">--</span>
                  <span class="stat-label">This Week</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Chat Page -->
      <div class="page" id="page-chat">
        <div class="page-header">
          <h1>Chat with Cal</h1>
        </div>
        <div class="chat-container">
          <div class="chat-messages" id="main-chat-messages"></div>
          <div class="chat-input-area" id="main-chat-input-area">
            <button class="voice-btn" id="main-voice-btn" title="Hold to record">üé§</button>
            <div class="voice-recording-indicator" id="main-recording-indicator">
              <span class="recording-dot"></span>
              <div class="waveform">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
              </div>
              <span class="recording-time" id="main-recording-time">0:00</span>
              <button class="cancel-btn" id="main-cancel-recording" title="Cancel">‚úï</button>
            </div>
            <div class="voice-preview" id="main-voice-preview">
              <span class="preview-icon">üé§</span>
              <div class="preview-waveform" id="main-preview-waveform"></div>
              <span class="preview-duration" id="main-preview-duration">0:00</span>
              <button class="clear-btn" id="main-clear-voice" title="Clear">‚úï</button>
            </div>
            <textarea id="main-chat-input" placeholder="Message Cal..." rows="1"></textarea>
            <button class="send-btn" id="main-send-btn">Send</button>
          </div>
        </div>
      </div>

      <!-- DNA Page -->
      <div class="page" id="page-dna">
        <div class="page-header">
          <h1>DNA</h1>
          <span class="page-subtitle">Core identity files</span>
        </div>
        <div class="dna-tabs">
          <button class="tab-btn active" data-file="SOUL.md">SOUL.md</button>
          <button class="tab-btn" data-file="IDENTITY.md">IDENTITY.md</button>
          <button class="tab-btn" data-file="USER.md">USER.md</button>
        </div>
        <div class="editor-container">
          <textarea class="file-editor" id="dna-editor" placeholder="Loading..."></textarea>
          <div class="editor-actions">
            <button class="btn btn-primary" id="save-dna-btn">Save Changes</button>
            <span class="save-status" id="dna-save-status"></span>
          </div>
        </div>
      </div>

      <!-- Memory Page -->
      <div class="page" id="page-memory">
        <div class="page-header">
          <h1>Memory</h1>
          <span class="page-subtitle">Browse and edit memory files</span>
        </div>
        <div class="memory-layout">
          <div class="memory-sidebar">
            <div class="memory-section">
              <h4>Long-term Memory</h4>
              <a href="#" class="memory-file" data-file="MEMORY.md">MEMORY.md</a>
            </div>
            <div class="memory-section">
              <h4>Daily Notes</h4>
              <div id="memory-file-list" class="memory-files"></div>
            </div>
          </div>
          <div class="memory-editor">
            <div class="memory-file-header">
              <span id="memory-current-file">Select a file</span>
            </div>
            <textarea class="file-editor" id="memory-editor" placeholder="Select a file to edit..."></textarea>
            <div class="editor-actions">
              <button class="btn btn-primary" id="save-memory-btn">Save Changes</button>
              <span class="save-status" id="memory-save-status"></span>
            </div>
          </div>
        </div>
      </div>

      <!-- Skills Page -->
      <div class="page" id="page-skills">
        <div class="page-header">
          <h1>Skills</h1>
          <span class="page-subtitle">Available capabilities</span>
        </div>
        <div class="skills-grid" id="skills-grid">
          <div class="empty-state">Loading skills...</div>
        </div>
      </div>

      <!-- Cron Jobs Page -->
      <div class="page" id="page-cron">
        <div class="page-header">
          <h1>Cron Jobs</h1>
          <span class="page-subtitle">Scheduled tasks</span>
        </div>
        <div class="cron-list" id="cron-list">
          <div class="empty-state">Loading cron jobs...</div>
        </div>
      </div>

      <!-- Placeholder Pages -->
      <div class="page" id="page-schedule">
        <div class="page-header">
          <h1>Schedule</h1>
        </div>
        <div class="placeholder-content">
          <div class="placeholder-icon">üìÖ</div>
          <p>Schedule view coming soon...</p>
        </div>
      </div>

      <div class="page" id="page-goals">
        <div class="page-header">
          <h1>Goals</h1>
        </div>
        <div class="placeholder-content">
          <div class="placeholder-icon">üéØ</div>
          <p>Goals tracking coming soon...</p>
        </div>
      </div>

      <div class="page" id="page-todo">
        <div class="page-header">
          <h1>To Do List</h1>
        </div>
        <div class="placeholder-content">
          <div class="placeholder-icon">‚úÖ</div>
          <p>To-do list coming soon...</p>
        </div>
      </div>

      <div class="page" id="page-missions">
        <div class="page-header">
          <h1>Mission Queue</h1>
        </div>
        <div class="placeholder-content">
          <div class="placeholder-icon">üöÄ</div>
          <p>Mission queue coming soon...</p>
        </div>
      </div>

      <div class="page" id="page-settings">
        <div class="page-header">
          <h1>Settings</h1>
        </div>
        <div class="settings-content">
          <div class="setting-group">
            <h3>Connection</h3>
            <div class="setting-row">
              <label>Gateway Status</label>
              <span id="gateway-status" class="status-badge">Checking...</span>
            </div>
          </div>
          <div class="setting-group">
            <h3>Theme</h3>
            <div class="setting-row">
              <label>Dark Mode</label>
              <span class="status-badge">Active</span>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Right Side Chat Panel -->
    <aside class="chat-panel" id="chat-panel">
      <div class="resize-handle" id="resize-handle"></div>
      <div class="chat-panel-header">
        <span>Quick Chat</span>
        <button class="minimize-btn" id="minimize-chat">‚àí</button>
      </div>
      <div class="chat-panel-body">
        <div class="chat-messages" id="side-chat-messages"></div>
        <div class="chat-input-area" id="side-chat-input-area">
          <button class="voice-btn" id="side-voice-btn" title="Hold to record">üé§</button>
          <div class="voice-recording-indicator" id="side-recording-indicator">
            <span class="recording-dot"></span>
            <div class="waveform">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
            </div>
            <span class="recording-time" id="side-recording-time">0:00</span>
            <button class="cancel-btn" id="side-cancel-recording" title="Cancel">‚úï</button>
          </div>
          <div class="voice-preview" id="side-voice-preview">
            <span class="preview-icon">üé§</span>
            <div class="preview-waveform" id="side-preview-waveform"></div>
            <span class="preview-duration" id="side-preview-duration">0:00</span>
            <button class="clear-btn" id="side-clear-voice" title="Clear">‚úï</button>
          </div>
          <textarea id="side-chat-input" placeholder="Message Cal..." rows="1"></textarea>
          <button class="send-btn" id="side-send-btn">‚Üë</button>
        </div>
      </div>
    </aside>

    <!-- Minimized Chat Bar -->
    <div class="chat-bar" id="chat-bar">
      <span>üí¨ Chat with Cal</span>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
